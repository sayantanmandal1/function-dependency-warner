(()=>{"use strict";var e,t,n,r={857:e=>{e.exports=require("os")},2018:e=>{e.exports=require("tty")},9023:e=>{e.exports=require("util")}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e].call(n.exports,n,n.exports,s),n.exports}s.m=r,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);s.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(e=>i[e]=()=>n[e]);return i.default=()=>n,s.d(o,i),o},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce((t,n)=>(s.f[n](e,t),t),[])),s.u=e=>e+".extension.js",s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n={792:1},s.f.require=(e,t)=>{n[e]||(e=>{var t=e.modules,r=e.ids,o=e.runtime;for(var i in t)s.o(t,i)&&(s.m[i]=t[i]);o&&o(s);for(var a=0;a<r.length;a++)n[r[a]]=1})(require("./"+s.u(e)))};var i={};s.r(i),s.d(i,{activate:()=>x,deactivate:()=>b});const a=require("vscode"),c=require("path"),l=require("fs");let u,f,d;const p=new Map;const y=new Map;async function h(e){try{if(!l.existsSync(e))return[];let t=y.get(e);switch(t||(t=l.readFileSync(e,"utf8"),y.set(e,t)),c.extname(e).toLowerCase()){case".js":case".ts":case".jsx":case".tsx":return async function(e,t){try{await async function(){u||(u=await s.e(172).then(s.bind(s,2172)),f=(await Promise.all([s.e(172),s.e(352),s.e(578)]).then(s.bind(s,5781))).default,d=await s.e(352).then(s.t.bind(s,2352,23)))}();let n=p.get(e);n||(n=u.parse(t,{sourceType:"unambiguous",plugins:["typescript","classProperties"]}),p.set(e,n));const r=[];return f(n,{FunctionDeclaration(t){t.node.id&&t.node.loc&&r.push({name:t.node.id.name,file:e,line:t.node.loc.start.line,type:"declaration"})},VariableDeclarator(t){t.node.init&&(d.isArrowFunctionExpression(t.node.init)||d.isFunctionExpression(t.node.init))&&d.isIdentifier(t.node.id)&&t.node.loc&&r.push({name:t.node.id.name,file:e,line:t.node.loc.start.line,type:"arrow"})},ClassMethod(t){d.isIdentifier(t.node.key)&&t.node.loc&&r.push({name:t.node.key.name,file:e,line:t.node.loc.start.line,type:"method"})}}),r}catch(t){return console.error("[FDW] Error parsing JS/TS file:",e,t),[]}}(e,t);case".java":return function(e,t){try{const n=[],r=t.split("\n"),o=/(?:public|private|protected|static|\s) +[\w\<\>\[\]]+\s+(\w+) *\([^\)]*\) *\{?/g;return r.forEach((t,r)=>{[...t.matchAll(o)].forEach(t=>{t[1]&&n.push({name:t[1],file:e,line:r+1,type:"method"})})}),n}catch(t){return console.error("[FDW] Error parsing Java file:",e,t),[]}}(e,t);case".py":return function(e,t){try{const n=[],r=t.split("\n"),o=/^\s*def\s+([a-zA-Z_]\w*)\s*\(/;return r.forEach((t,r)=>{const s=t.match(o);s&&n.push({name:s[1],file:e,line:r+1,type:"function"})}),n}catch(t){return console.error("[FDW] Error parsing Python file:",e,t),[]}}(e,t);default:return[]}}catch(t){return console.error("[FDW] Error processing file:",e,t),[]}}let m={};function g(e){const t=new Set,n=new Set;return function e(r){t.has(r)||(t.add(r),(m[r]||[]).forEach(t=>{n.add(t),e(t)}))}(e),Array.from(n)}const w=new WeakMap;async function j(e){try{const t=[],n=["**/*.{js,ts,jsx,tsx}","**/*.java","**/*.py","**/src/**/*.{js,ts,jsx,tsx,java,py}","**/lib/**/*.{js,ts,jsx,tsx,java,py}","**/app/**/*.{js,ts,jsx,tsx,java,py}"];for(const r of n){const n=await a.workspace.findFiles(r,"**/node_modules/**");for(const r of n)try{const n=await a.workspace.openTextDocument(r);let o=w.get(n);o||(o=h(r.fsPath),w.set(n,o));const s=await o;for(const n of s)e.includes(n.name)&&t.push(n)}catch(e){console.error("[FDW] Error processing file:",r.fsPath,e)}}return t}catch(e){return console.error("[FDW] Error finding files:",e),[]}}function x(e){try{console.log("[FDW] Extension activating...");const t=a.workspace.workspaceFolders?.[0]?.uri.fsPath;if(!t)return;const n=c.join(t,"dependencies.json");if(l.existsSync(n))try{const e=l.readFileSync(n,"utf8");m=JSON.parse(e),console.log("[FDW] Loaded dependency graph:",m)}catch(e){console.error("[FDW] Error loading dependencies.json:",e)}let r;const o=a.workspace.onDidChangeTextDocument(async e=>{try{const t=a.window.activeTextEditor;if(!t||t.document!==e.document)return;r&&clearTimeout(r),r=setTimeout(async()=>{const e=t.document.getText();for(const t of Object.keys(m))if([`def ${t}\\s*\\(`,`function\\s+${t}\\s*\\(`,`${t}\\s*=\\s*(?:async\\s*)?(?:function\\s*)?\\(`,`(?:public|private|protected)\\s+(?:static\\s+)?(?:[\\w<>\\[\\]]+\\s+)?${t}\\s*\\(`,`@\\w+\\s*[\\r\\n\\s]*(?:public|private|protected)\\s+(?:static\\s+)?(?:[\\w<>\\[\\]]+\\s+)?${t}\\s*\\(`].some(t=>new RegExp(t).test(e))){const e=g(t);if(e.length>0){const n=await j([t,...e]),r={};e.forEach(e=>{const t=Object.entries(m).find(([t,n])=>n.includes(e))?.[0];t&&(r[t]=r[t]||[],r[t].push(e))});const o=`⚠️ Warning: Changing '${t}' may affect:\n${e.map(e=>{const t=n.filter(t=>t.name===e);return t.length>0?t.map(t=>`${e} (${c.basename(t.file)}:${t.line})`).join(", "):`${e} (searching...)`}).join("\n")}`;a.window.showWarningMessage(o);const s=e.filter(e=>!n.some(t=>t.name===e));s.length>0&&j(s).then(e=>{if(e.length>0){const t=`Additional locations found:\n${e.map(e=>`${e.name} (${c.basename(e.file)}:${e.line})`).join("\n")}`;a.window.showInformationMessage(t)}})}break}},300)}catch(e){console.error("[FDW] Error in change handler:",e)}});e.subscriptions.push(o),console.log("[FDW] Extension activated successfully")}catch(e){console.error("[FDW] Error during activation:",e)}}function b(){}module.exports=i})();